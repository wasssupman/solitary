# 유닛 소환 & Spell 시스템

## 개요

이 문서는 Solitary Defense의 핵심 메커니즘인 **유닛 소환 시스템**과 **Spell 토큰 시스템**을 정의합니다. 유닛 소환은 Foundation 진행도를 바탕으로 한 2-Suit 조합 시스템으로 작동하며, Spell 시스템은 Tableau 플레이와 디펜스 페이즈를 연결하는 전략적 도구입니다.

---

## 1. 유닛 소환 시스템

### 1.1 기본 원칙 — 2-Suit 조합

유닛 소환은 **두 개의 Foundation 진행도**를 기반으로 합니다.

- **티어 결정**: 두 Foundation 중 **최소 랭크**가 해당 조합의 티어를 결정
- **소환 조건**: 두 Foundation이 동등 레벨에 도달한 상태에서 다음 카드를 올릴 때 합성 유닛 소환 가능

**예시:**
- ♠ Foundation: A-2-3-4-5-6-7
- ♥ Foundation: A-2-3-4-5
- 최소 랭크 = 5 → **티어 2**까지 소환 가능
- ♥6을 올리면 최소 랭크가 6이 되어 티어 2 유닛(기사) 소환 가능

**티어 단계:**
| 티어 | Foundation 진행도 | 필요 랭크 |
|------|------------------|----------|
| 티어 1 | A-2-3 | A-3 |
| 티어 2 | A-2-3-4-5-6 | A-6 |
| 티어 3 | A-2-3-4-5-6-7-8-9 | A-9 |
| 티어 4 | A-2-3-4-5-6-7-8-9-10-J-Q-K | A-K |

### 1.2 6가지 Suit 조합

각 조합은 고유한 역할과 4단계 진화 경로를 가집니다.

| 조합 | 역할 | 티어1 (A-3) | 티어2 (A-6) | 티어3 (A-9) | 티어4 (A-K) |
|------|------|------------|------------|------------|------------|
| ♠+♥ | 공격+회복 | 검사 | 기사 | 팔라딘 | 드래곤 슬레이어 |
| ♠+♦ | 공격+원거리 | 궁수 | 크로스보우 | 스나이퍼 | 아티피서 |
| ♥+♦ | 회복+원거리 | 힐러 | 버퍼 | 배리어 | 피닉스 |
| ♣+♠ | 마법+공격 | 마법사 | 서머너 | 네크로맨서 | 리치 |
| ♣+♥ | 마법+회복 | 로그 | 어쌔신 | 섀도우 | 리퍼 |
| ♣+♦ | 마법+원거리 | 미니언 | 가디언 | 포트리스 | 콜로서스 |

**조합 예시:**
- **♠+♥ (검사 라인)**: 근접 공격 + 자체 회복으로 전선 유지에 특화
- **♥+♦ (힐러 라인)**: 아군 지원 + 원거리 공격의 유틸리티 역할
- **♣+♠ (마법사 라인)**: 광역 마법 + 소환물로 다수 처리

### 1.3 소환 비용 (Energy)

유닛 소환에는 Energy가 소모됩니다.

| 티어 | 소환 비용 (Energy) |
|------|------------------|
| 티어 1 | 2 |
| 티어 2 | 4 |
| 티어 3 | 7 |
| 티어 4 | 12 |

**복수 소환 규칙:**
- 동일 조합의 유닛을 여러 번 소환 가능
- **2번째부터 효율 70%**: 같은 조합의 두 번째 유닛은 비용의 70%만큼 효율 감소
  - 예: 티어 2 기사(비용 4) → 2번째 기사는 효율 70% (실질 비용 대비 성능 하락)
  - 다양한 조합 활용을 유도하는 밸런싱 요소

### 1.4 유닛 배치 — 5개 고정 슬롯

유닛은 화면의 **5개 고정 위치**에 배치됩니다.

```
[슬롯1] [슬롯2] [슬롯3] [슬롯4] [슬롯5]
   ↓       ↓       ↓       ↓       ↓
────────────────────────────────────────
        몬스터 진입 방향 →
```

**슬롯 특성:**
- 슬롯 위치에 따라 사거리와 효과 범위가 달라질 수 있음
- 근접 유닛(검사, 팔라딘)은 앞쪽 슬롯에, 원거리 유닛(궁수, 마법사)은 뒤쪽 슬롯에 배치하는 것이 유리
- 최대 5기까지만 배치 가능 → 조합 선택의 전략적 중요성 증가

### 1.5 궁극기 — 세븐즈 아포칼립스

**발동 조건:**
- 4개 Suit(♠, ♥, ♦, ♣) 모두 **7 이상** 도달

**효과:**
- 화면 전체 몬스터 즉시 제거
- **게임당 1회 제한**

**설계 의도:**
- 4-Suit 병렬 관리를 유도하는 마일스톤 보상
- 위기 상황 돌파를 위한 전략적 선택지
- 7이라는 중간 랭크 목표로 초반-중반 목표 제시

**예시 상황:**
- 몬스터 웨이브가 폭주하여 방어선 붕괴 직전
- 세븐즈 아포칼립스 발동 → 화면 클리어 → 재정비 시간 확보

---

## 2. Spell 토큰 시스템

### 2.1 개요

Spell 토큰은 **Tableau 카드 뒤집기**를 통해 획득하며, 디펜스 페이즈에서 전략적으로 사용할 수 있는 특수 능력입니다.

**핵심 설계 철학:**
- Tableau 플레이(솔리테어 행위)가 디펜스에 직접 가치를 제공 → 양방향 시너지
- 솔리테어와 디펜스를 단순 교대가 아닌 **유기적 연결**로 만듦

### 2.2 토큰 획득

**획득 규칙:**
- Tableau에서 뒷면 카드를 뒤집을 때마다 **Spell 토큰 +1**

**예시:**
- Tableau에서 카드 이동 → 숨겨진 카드 1장 공개 → 토큰 +1
- 5장 뒤집기 → 토큰 +5

### 2.3 Spell 종류

| Spell | 비용 | 효과 | 사용 타이밍 |
|-------|------|------|-----------|
| **Freeze** | 1 토큰 | 몬스터 1기를 3초간 정지 | 디펜스 페이즈 |
| **Boost** | 2 토큰 | 유닛 1기의 공격력을 2배로 증가 (5초간) | 디펜스 페이즈 |
| **Recall** | 3 토큰 | Foundation 카드 1장을 Tableau로 복귀 (Energy 환불) | 솔리테어 페이즈 |

### 2.4 각 Spell 상세 설명

#### Freeze (냉결)
- **비용**: 1 토큰
- **효과**: 선택한 몬스터 1기를 3초간 정지
- **용도**:
  - 강력한 보스급 몬스터의 진행 지연
  - 유닛 재배치 시간 확보
  - 긴급 상황 대응

**예시 상황:**
- 고속 이동 몬스터가 방어선 돌파 직전 → Freeze로 정지 → 유닛 재배치

#### Boost (강화)
- **비용**: 2 토큰
- **효과**: 선택한 유닛 1기의 공격력을 5초간 2배로 증가
- **용도**:
  - 보스 몬스터 집중 화력
  - 위기 상황 순간 화력 증폭
  - 티어 낮은 유닛의 활용도 증가

**예시 상황:**
- 보스 몬스터 출현 → 티어 4 드래곤 슬레이어에 Boost 사용 → 빠른 처치

#### Recall (회수)
- **비용**: 3 토큰
- **효과**: Foundation에서 카드 1장을 선택하여 Tableau로 복귀, 해당 카드로 소환한 유닛은 소멸하고 Energy 환불
- **용도**:
  - 잘못된 소환 전략 수정
  - Undo 대체 메커니즘
  - 막힌 Tableau 상황 타개

**설계 의도:**
- 전통적인 Undo 기능을 **비용을 지불하는 전략적 선택**으로 전환
- 3토큰이라는 높은 비용으로 남발 방지
- Foundation 진행을 되돌림으로써 유닛 조합 재구성 가능

**예시 상황:**
- ♠+♥으로 팔라딘 소환했으나 ♠+♦ 조합이 더 필요한 상황
- Recall로 ♠ Foundation 카드 1장 복귀 → Energy 환불
- ♠+♦ 경로로 재소환

### 2.5 Spell 전략 팁

**토큰 관리:**
- Tableau 뒤집기를 적극적으로 수행하여 토큰 확보
- Freeze는 저렴하지만 Recall은 3배 비용 → 용도별 우선순위 설정

**타이밍:**
- Freeze/Boost: 디펜스 페이즈 중 실시간 사용
- Recall: 솔리테어 페이즈에서 전략 수정 시 사용

**시너지:**
- Tableau 많이 뒤집기 → 토큰 축적 → 디펜스 강화
- 솔리테어 플레이가 방어력 향상으로 직결

---

## 3. 시스템 간 시너지

### 3.1 Foundation ↔ 유닛 소환
- Foundation 진행도가 곧 유닛 티어
- 4-Suit 균형 발전 시 세븐즈 아포칼립스 보상

### 3.2 Tableau ↔ Spell 토큰
- Tableau 뒤집기가 즉시 디펜스 자원으로 전환
- 솔리테어 플레이 자체가 전투 준비

### 3.3 Energy 경제
- Foundation 진행 → Energy 획득
- Energy → 유닛 소환
- Recall → Energy 환불 (전략 수정 가능)

---

## 4. 밸런싱 고려사항

### 4.1 복수 소환 페널티
- 동일 조합 2번째부터 효율 70%
- 6가지 조합을 골고루 활용하도록 유도

### 4.2 Spell 비용 차등
- Freeze(1) < Boost(2) < Recall(3)
- Recall의 높은 비용으로 무한 Undo 방지

### 4.3 세븐즈 아포칼립스
- 게임당 1회 제한으로 신중한 사용 필요
- 4-Suit 병렬 관리라는 높은 난이도 보상

---

## 5. UI/UX 고려사항

### 5.1 유닛 소환 UI
- Foundation 위에 현재 소환 가능한 티어 표시
- 조합별 아이콘과 비용 명시
- 슬롯 5개 시각적 구분

### 5.2 Spell 토큰 UI
- 우측 상단에 보유 토큰 수 표시
- 각 Spell 아이콘 + 비용 + 쿨다운 표시
- 드래그 앤 드롭 또는 클릭으로 사용

### 5.3 세븐즈 아포칼립스 UI
- 4-Suit 진행도 게이지
- 발동 가능 시 화면 중앙에 버튼 강조
- 사용 후 "1회 사용됨" 표시

---

## 6. 향후 확장 가능성

### 6.1 추가 Spell
- AOE Spell (광역 효과)
- 버프/디버프 계열
- 자원 교환 Spell

### 6.2 유닛 특수 능력
- 티어 4 유닛의 고유 스킬
- 조합 간 시너지 효과

### 6.3 궁극기 변형
- 세븐즈 외 다른 조건의 궁극기 추가
- 예: 모든 Suit A-K 완성 시 "로얄 플러시" 궁극기

---

## 참고

- 본 문서는 Creative Rule Agent가 작성
- 기반 게임: Klondike Solitaire + Tower Defense 하이브리드
- 관련 문서: `01-core-loop.md`, `03-wave-system.md`
