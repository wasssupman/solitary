# Core Loop - 솔리테어 디펜스 핵심 루프

## 개요

"Solitaire Defense"는 클론다이크 솔리테어의 카드 조작 메커닉과 전략 디펜스의 웨이브 방어 메커닉을 결합한 게임 모드이다. 플레이어는 솔리테어를 플레이하면서 카드를 Foundation에 올리는 행위를 통해 유닛을 소환하고, 적 웨이브를 방어한다.

## 핵심 루프: 3단계 사이클

### Phase 1: Card Phase (솔리테어 조작)

플레이어는 제한된 턴/시간 안에 클론다이크 솔리테어를 플레이한다.

- **Tableau 조작**: 표준 Klondike 규칙 그대로 (내림차순 교대색, K만 빈 열)
- **Stock/Waste**: 3장씩 드로우, 순환
- **Foundation 적재**: A부터 오름차순으로 같은 Suit 적재 -> **이 행위가 유닛 소환 트리거**
- **턴 제한**: 웨이브당 **15턴** (한 턴 = 하나의 카드 이동 액션). Stock 클릭도 1턴 소모

핵심: 솔리테어의 모든 규칙을 보존하되, Foundation 적재가 "자원 수확"의 의미를 갖는다.

### Phase 2: Deploy Phase (유닛 배치)

Card Phase에서 Foundation에 올린 카드들이 소환 가능한 유닛/스펠 풀로 변환된다.

- Foundation에 올린 카드의 **Suit + Rank 조합**이 유닛 타입과 등급을 결정
- 플레이어는 **5x1 디펜스 레인**에 유닛을 배치
- 배치 후 남은 미사용 카드는 다음 웨이브로 이월 (최대 보유: 5장)

### Phase 3: Battle Phase (자동 전투)

배치된 유닛이 좌에서 우로 진행하는 적 웨이브와 전투한다.

- 전투는 **자동 진행** (플레이어 개입 없음)
- 유닛은 사거리 내 적을 공격, 적은 유닛/기지를 공격
- 기지 HP가 0이 되면 게임 오버
- 웨이브 클리어 시 Phase 1으로 복귀

## 메카닉 연결점: "Foundation = 병영"

솔리테어와 디펜스의 연결은 **Foundation 파일**을 통해 이루어진다.

| 솔리테어 개념 | 디펜스 개념 | 연결 방식 |
|-------------|-----------|----------|
| Foundation 적재 | 유닛 생산 | 카드를 Foundation에 올릴 때마다 유닛 풀에 추가 |
| Suit (4종) | 유닛 클래스 (4종) | 각 Suit가 고유한 유닛 클래스에 매핑 |
| Rank (A-K) | 유닛 등급 | 높은 Rank = 더 강한 유닛 |
| Tableau 정리 | 전략적 선택 | 어떤 Suit를 먼저 올릴지 = 어떤 유닛을 먼저 소환할지 |

## 한 판의 흐름 (Full Game)

```
Game Start
  -> Deal (표준 Klondike 배치)
  -> Wave 1: Card Phase -> Deploy Phase -> Battle Phase
  -> Wave 2: Card Phase -> Deploy Phase -> Battle Phase
  -> ...
  -> Wave 10: Card Phase -> Deploy Phase -> Battle Phase
  -> Victory (또는 중간에 Game Over)
```

- 총 **10 웨이브** 구성
- 같은 52장 덱을 **게임 내내** 사용 (Foundation에 올린 카드는 제거, 잔여 카드로 다음 웨이브 진행)
- 52장을 다 올리면 모든 유닛을 생산한 것 = 최대 전력

## 핵심 딜레마

1. **속도 vs 품질**: 제한된 턴 안에 많은 카드를 올리고 싶지만, 높은 Rank 카드(강한 유닛)를 올리려면 더 많은 턴이 필요
2. **Suit 우선순위**: 현재 웨이브의 적 속성에 맞는 Suit를 먼저 올릴지, 장기적으로 유리한 Suit를 올릴지
3. **Tableau 투자**: Tableau를 잘 정리하면 이후 웨이브에서 효율적이지만, 당장 Foundation에 올릴 카드가 줄어듦
4. **보유 카드 관리**: 미사용 유닛을 이월할지, 약한 유닛이라도 즉시 배치할지
