# PRD: Solitaire Survivors Mode

## 1. Executive Summary

**Mode Name**: Solitaire Survivors
**Genre Tags**: Solitaire + Survivors-like, Real-time Action Card Game
**Base Game**: Solitary -- Klondike Solitaire with AI Solver

### Key Differentiators (vs Core Solitaire)
1. **Foundation-as-Arsenal**: Foundationì— ì¹´ë“œë¥¼ ì˜¬ë¦´ ë•Œë§ˆë‹¤ íˆ¬ì‚¬ì²´ê°€ ì¦‰ì‹œ ë°œì‚¬ë˜ê³  ì˜êµ¬ì ìœ¼ë¡œ ê°•í™”ë˜ë©°, ì†”ë¦¬í…Œì–´ ì§„í–‰ì´ ê³§ ì „íˆ¬ë ¥ ì¦ê°€ë¡œ ì´ì–´ì§„ë‹¤.
2. **Real-time Simultaneous Play**: í„´ì œê°€ ì•„ë‹Œ ì‹¤ì‹œê°„ ë™ì‹œ ì§„í–‰. í”Œë ˆì´ì–´ëŠ” í•˜ë‹¨ì—ì„œ ì†”ë¦¬í…Œì–´ë¥¼ í”Œë ˆì´í•˜ëŠ” ë™ì•ˆ ìƒë‹¨ì—ì„œ ìë™ ì „íˆ¬ê°€ ê³„ì†ë˜ë©°, ë©ˆì¶”ì§€ ì•ŠëŠ” ê¸´ì¥ê°ì„ ì œê³µí•œë‹¤.
3. **Positive Feedback Loop**: ì†”ë¦¬í…Œì–´ ì§„í–‰ â†’ ì „íˆ¬ë ¥ ìƒìŠ¹ â†’ ì  ì²˜ì¹˜ â†’ ì•¼ìƒì¹´ë“œ íšë“ â†’ ì†”ë¦¬í…Œì–´ ëŒíŒŒêµ¬ ì œê³µì´ë¼ëŠ” ì–‘ë°©í–¥ ê¸ì •ì  ìƒìŠ¹ ë‚˜ì„  êµ¬ì¡°.

### Concept
Solitaire SurvivorsëŠ” í´ë¡ ë‹¤ì´í¬ ì†”ë¦¬í…Œì–´ ë©”ì¹´ë‹‰ê³¼ Vampire Survivors ìŠ¤íƒ€ì¼ ì‹¤ì‹œê°„ ìƒì¡´ ì•¡ì…˜ì„ ìœµí•©í•œë‹¤. í”Œë ˆì´ì–´ ìºë¦­í„°ëŠ” í™”ë©´ ì¤‘ì•™ì— ê³ ì •ë˜ì–´ ì‚¬ë°©ì—ì„œ ì ‘ê·¼í•˜ëŠ” ì ì„ ìë™ íˆ¬ì‚¬ì²´ë¡œ ê³µê²©í•˜ë©°, í”Œë ˆì´ì–´ëŠ” í•˜ë‹¨ì˜ ì†”ë¦¬í…Œì–´ë¥¼ ì¡°ì‘í•˜ì—¬ íˆ¬ì‚¬ì²´ë¥¼ ê°•í™”í•œë‹¤. 10ë¶„ê°„ 10ê°œ ì›¨ì´ë¸Œë¥¼ ìƒì¡´í•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë©°, ì†”ë¦¬í…Œì–´ë¥¼ ì˜ í’€ìˆ˜ë¡ ì „íˆ¬ê°€ ê°•í•´ì§€ê³ , ì „íˆ¬ë¥¼ ì˜í• ìˆ˜ë¡ ì†”ë¦¬í…Œì–´ ì§„í–‰ì´ ì‰¬ì›Œì§„ë‹¤.

---

## 2. Mode Vision & Goals

### Value Proposition
ê¸°ì¡´ ì†”ë¦¬í…Œì–´ëŠ” ì •ì ì¸ í¼ì¦ ê²½í—˜ì„ ì œê³µí•˜ì§€ë§Œ ì¥ê¸°ì  ëª°ì…ë„ê°€ ë‚®ë‹¤. Solitaire SurvivorsëŠ” "ë©ˆì¶”ì§€ ì•ŠëŠ” ì‹¤ì‹œê°„ ì „íˆ¬"ë¼ëŠ” ì™¸ë¶€ ì••ë°•ì„ ì¶”ê°€í•˜ì—¬ ì†”ë¦¬í…Œì–´ì˜ ëª¨ë“  ì„ íƒì— ì „ìˆ ì  ë¬´ê²Œë¥¼ ë¶€ì—¬í•œë‹¤. ë™ì‹œì— Survivors-like ì¥ë¥´ì˜ ìë™ ì„±ì¥ ì¾Œê°ê³¼ ë ˆë²¨ì—… ì„ íƒì˜ ì „ëµì„±ì„ ì œê³µí•˜ì—¬, ì•¡ì…˜ ê²Œì„ í”Œë ˆì´ì–´ì™€ í¼ì¦ ê²Œì„ í”Œë ˆì´ì–´ ëª¨ë‘ë¥¼ ë§Œì¡±ì‹œí‚¨ë‹¤.

### Success Criteria
| Metric | Target | Measurement |
|--------|--------|-------------|
| Mode adoption rate | > 40% of active users try within 7 days | Analytics |
| Mode session share | > 25% of total sessions | Analytics |
| Mode D7 retention | > 35% | Cohort |
| Cross-mode engagement | 70% play both modes weekly | Analytics |
| Avg session length | 10-15 min (survivors), vs 5-10 min (core) | Analytics |
| Session completion rate | > 25% (10ë¶„ ìƒì¡´ ì™„ë£Œ) | Analytics |

---

## 3. Target Players & Personas

### Persona: Action Seeker Alex
- **Profile**: Midcore
- **Relationship to Core Solitaire**: Occasional player, prefers action games
- **Play Sessions**: 15-30 min sessions, evening gaming
- **Motivations**: Vampire Survivors íŒ¬ìœ¼ë¡œ ë¹Œë“œ ìµœì í™”ì™€ ë ˆë²¨ì—… ì„ íƒì˜ ì „ëµì„±ì„ ì¦ê¹€. "ì†”ë¦¬í…Œì–´ë¥¼ ì•¡ì…˜ ê²Œì„ìœ¼ë¡œ ë§Œë“ ë‹¤"ëŠ” ì»¨ì…‰ì— í¥ë¯¸
- **Pain Points**: ìˆœìˆ˜ ì†”ë¦¬í…Œì–´ëŠ” ë„ˆë¬´ ëŠë¦¬ê³  ì •ì . ì „í†µ VS ê²Œì„ì€ ì´ë™ ì¡°ì‘ì´ ë²ˆê±°ë¡œì›€

### Persona: Hybrid Hannah
- **Profile**: Casual
- **Relationship to Core Solitaire**: Regular player, 2-3 sessions/week
- **Play Sessions**: 10-20 min sessions, lunch breaks
- **Motivations**: ì†”ë¦¬í…Œì–´ì˜ ìµìˆ™í•¨ + ìƒˆë¡œìš´ ë„ì „. "ë‚´ê°€ ì•„ëŠ” ê·œì¹™ìœ¼ë¡œ ìƒˆ ê²½í—˜"ì„ ì›í•¨
- **Pain Points**: ì†”ë¦¬í…Œì–´ê°€ ë§‰íˆë©´ ë‹µë‹µí•¨. ì•¡ì…˜ ê²Œì„ì€ ì¡°ì‘ì´ ë³µì¡í•´ì„œ ë¶€ë‹´

### Persona: Completionist Chris
- **Profile**: Hardcore
- **Relationship to Core Solitaire**: Expert player, solver ì´í•´
- **Play Sessions**: 30-60 min focused sessions
- **Motivations**: S-rank ë‹¬ì„±, Full Suit ì™„ì„±, ë“€ì–¼ ì½¤ë³´ í•´ê¸ˆ ë“± ë§ˆì¼ìŠ¤í†¤ ì¶”ì . ë¹Œë“œ ìµœì í™” ì‹¤í—˜
- **Pain Points**: ê¸°ì¡´ ì†”ë¦¬í…Œì–´ëŠ” ë³€ìˆ˜ê°€ ì ì–´ ê¸ˆë°© ì§€ë£¨í•¨. ë” ë³µì¡í•œ ì „ëµì„ ì›í•¨

---

## 4. Core Loop & Session Design

### Core Loop Diagram

```mermaid
graph LR
    A[Game Start<br/>52ì¥ ë”œë§] --> B[ì‹¤ì‹œê°„ ë™ì‹œ ì§„í–‰]
    B --> C{10ë¶„ ê²½ê³¼?}
    C -->|No| D[Foundation ì ì¬<br/>â†’ íˆ¬ì‚¬ì²´ ê°•í™”]
    D --> E[ì  ì²˜ì¹˜<br/>â†’ ê²½í—˜ì¹˜/ì•¼ìƒì¹´ë“œ]
    E --> F[ë ˆë²¨ì—… ì„ íƒ]
    F --> G[ì›¨ì´ë¸Œ í´ë¦¬ì–´<br/>â†’ face-down reveal]
    G --> B
    C -->|Yes, HP > 0| H[Victory!<br/>ìŠ¤ì½”ì–´ + ë“±ê¸‰]
    C -->|HP = 0| I[Game Over<br/>ìŠ¤ì½”ì–´ + ë“±ê¸‰]
```

### Solitaire Intersection Points
- **ì‹¤ì‹œê°„ ì§„í–‰** ì¤‘ í‘œì¤€ Klondike ê·œì¹™ 100% ì ìš© (reuses `SolitaireCore`, `SolitaireState`)
- Foundation ì ì¬ ì‹œ ì¦‰ì‹œ 2ê°€ì§€ íš¨ê³¼: (1) íˆ¬ì‚¬ì²´ 1ë°œ ë°œì‚¬ (2) í•´ë‹¹ Suit íˆ¬ì‚¬ì²´ Tier ì˜êµ¬ ìƒìŠ¹
- ì „íˆ¬ì™€ ì†”ë¦¬í…Œì–´ê°€ **ë™ì‹œì— ì§„í–‰**ë˜ë©° ì„œë¡œ ì˜í–¥ì„ ì£¼ê³ ë°›ìŒ

### Session Comparison
| Aspect | Core Solitaire | Solitaire Survivors |
|--------|---------------|---------------------|
| Session Length | 3-10 min | 10-15 min |
| Win Condition | All 52 cards to foundation | Survive 10 minutes (10 waves) |
| Fail Condition | No moves available | Player HP reaches 0 |
| Replayability | Seed-based | Seed + wave randomization + levelup choices |
| Scoring | Win/Lose binary | Multi-factor score (S/A/B/C/D ranking) |
| Pacing | Turn-based, contemplative | Real-time, intense |

### FTUE (First Time User Experience)
1. **Discovery**: "Survivors Mode" button on main menu (`/`), tagline: "Real-time solitaire action - survive 10 minutes!"
2. **Tutorial Wave (Wave 1)**: ê°„ë‹¨í•œ ì˜¤ë²„ë ˆì´ ì•ˆë‚´: "Foundationì— ì¹´ë“œë¥¼ ì˜¬ë ¤ íˆ¬ì‚¬ì²´ë¥¼ ê°•í™”í•˜ì„¸ìš”. ì ì˜ ì•½ì  ë§ˆí¬ë¥¼ í™•ì¸í•˜ì„¸ìš”!"
3. **First Success Moment**: Wave 1 í´ë¦¬ì–´(1ë¶„) â†’ face-down ì¹´ë“œ 1ì¥ ìë™ reveal + "WAVE CLEARED!" í”¼ë“œë°±
4. **Unguided Play**: Wave 2ë¶€í„°ëŠ” ì•ˆë‚´ ì—†ì´ ììœ¨ í”Œë ˆì´. ë ˆë²¨ì—… ì„ íƒì§€ê°€ ìì—°ìŠ¤ëŸ½ê²Œ ì‹œìŠ¤í…œ í•™ìŠµ ìœ ë„

---

## 5. Shared Infrastructure

### Reuse Matrix
| Component | File | Reuse Strategy |
|-----------|------|---------------|
| GameBridge | `game/bridge/GameBridge.ts` | Extend (add survivors callbacks) |
| CardSprite | `game/objects/CardSprite.ts` | Reuse as-is |
| CardRenderer | `game/rendering/CardRenderer.ts` | Reuse as-is (same textures) |
| LayoutManager | `game/rendering/LayoutManager.ts` | New instance (survivors layout config) |
| SpriteManager | `game/sprites/SpriteManager.ts` | Extend (add survivors sprite pools) |
| InteractionController | `game/interaction/InteractionController.ts` | Reuse (standard solitaire drag-drop) |
| ThemeManager | `game/rendering/ThemeManager.ts` | Reuse as-is |
| SolitaireCore | `game/core/SolitaireCore.ts` | Wrap (survivors events on Foundation moves) |
| SolitaireState | `solver/SolitaireState.ts` | Reference (solitaire sub-state) |
| NestedRolloutSolver | `solver/NestedRolloutSolver.ts` | Reuse (hint system) |
| Deck | `solver/Deck.ts` | Reuse (seeded shuffle) |
| CardMovementRunner | `game/movement/CardMovementRunner.ts` | Reuse (card animations) |
| AnimationManager | `game/rendering/AnimationManager.ts` | Reuse (card move animations) |
| PileZone | `game/objects/PileZone.ts` | Reuse (tableau/foundation zones) |
| Types | `solver/types.ts` | Reuse (Card, Suit, Move, ActionType) |

### Solitaire Core Reference
- **Rules reused as-is**: Tableau stacking (descending, alternating color), Foundation building (ascending, same suit), Stock draw (3 cards), Waste cycling, Partial stack moves
- **Rules unchanged**: No Klondike rules are modified
- **Mode-specific additions**: Real-time battle overlay, Foundation-to-projectile conversion events, Wild card system

---

## 6. Feature Requirements (MoSCoW)

| Priority | Feature | New / Reuse | GDD Source | Acceptance Criteria |
|----------|---------|-------------|------------|---------------------|
| **Must** | Real-time simultaneous play | New | `[GDD: 01-core-loop]` | Solitaire and battle both active; no phase transitions; time continues |
| **Must** | Foundation-to-Projectile conversion | New | `[GDD: 01-core-loop, 02-projectile-system]` | Each card placed on Foundation fires 1 instant projectile + permanently increases projectile count for that Suit |
| **Must** | 4 Projectile Types (Slash/Holy Orb/Arrow/Fireball) | New | `[GDD: 02-projectile-system]` | Each Suit maps to distinct projectile with unique behavior per GDD table |
| **Must** | Projectile count scaling | New | `[GDD: 02-projectile-system]` | Count = `ceil(Foundation Rank / 3)`, min 1 max 5 |
| **Must** | Player character (fixed position) | New | `[GDD: 01-core-loop]` | Character fixed at center, HP system, invincibility frames on hit |
| **Must** | 360-degree enemy spawning | New | `[GDD: 03-enemy-and-wave]` | Enemies spawn from all edges, move toward player, contact damage |
| **Must** | 10-minute 10-wave structure | New | `[GDD: 03-enemy-and-wave]` | Each wave = 1 minute, difficulty scaling per GDD table |
| **Must** | 6 Enemy types (Grunt/Runner/Shield/Ranger/Healer/Siege) | New | `[GDD: 03-enemy-and-wave]` | Each type has correct stats and behavior per GDD |
| **Must** | Enemy weakness system | New | `[GDD: 03-enemy-and-wave]` | Each enemy shows 1 Suit weakness icon; weakness = x2.0 damage |
| **Must** | Wild card drop system | New | `[GDD: 04-feedback-and-safety]` | 15% drop rate on enemy kill; 3 types: Joker(7%), Peek(5%), Bomb(3%) |
| **Must** | Levelup system | New | `[GDD: 03-enemy-and-wave]` | XP from kills + face-down flips; 3 levelups at Wave 3/6/9; 3-choice UI |
| **Must** | SurvivorsScene (Phaser) | New | `[GDD: 05-ui-and-integration]` | New scene with split layout: battle top 55%, solitaire bottom 35% |
| **Must** | `/survivors` route | New | `[GDD: 05-ui-and-integration]` | Next.js page at `/survivors` loads SurvivorsScene |
| **Should** | Combo timer system | New | `[GDD: 02-projectile-system]` | 10-second window for consecutive Foundation placement; 1x â†’ 1.3x â†’ 1.6x â†’ 2.0x damage scaling |
| **Should** | Rank bonus damage | New | `[GDD: 02-projectile-system]` | Rank 10-K grants x1.3 damage multiplier |
| **Should** | Full Suit (K completion) special effects | New | `[GDD: 02-projectile-system]` | K completion grants permanent projectile upgrade per Suit per GDD |
| **Should** | Dual combos (Red/Black/Royal) | New | `[GDD: 02-projectile-system]` | 2-Suit and 4-Suit Tier threshold combos with fusion projectiles |
| **Should** | Chain gauge system | New | `[GDD: 04-feedback-and-safety]` | Tableau-to-Tableau moves charge gauge; 100% = 3s firing speed x2 burst |
| **Should** | Barrier zones (empty Tableau columns) | New | `[GDD: 04-feedback-and-safety]` | Empty columns create slow zones in corresponding battle areas (50% speed reduction) |
| **Should** | Wave clear reward | New | `[GDD: 04-feedback-and-safety]` | Auto-reveal 1 face-down card per wave cleared |
| **Should** | 2 Minibosses (Brute/Shadow) | New | `[GDD: 03-enemy-and-wave]` | Wave 4 and 7 minibosses with special mechanics and guaranteed wild card drop |
| **Should** | Final boss (King of Ruin) | New | `[GDD: 03-enemy-and-wave]` | Wave 10 boss with 3-phase fight, Suit weakness rotation |
| **Should** | Scoring system with S/A/B/C/D ranks | New | `[GDD: 03-enemy-and-wave]` | Score from multiple factors: time, kills, foundation progress, combos |
| **Could** | Bomb dual-use mechanic | New | `[GDD: 04-feedback-and-safety]` | Foundation placement = screen explosion; Tableau placement = flip 2 face-down |
| **Could** | Stock cycling slow effect | New | `[GDD: 04-feedback-and-safety]` | Stock draw triggers 0.5s enemy slow (30%) |
| **Could** | New deck dealing option | New | `[GDD: 04-feedback-and-safety]` | After 52-card completion, option to deal new deck while keeping Foundation |
| **Could** | Mobile-optimized layout | New | `[GDD: 05-ui-and-integration]` | On <768px, swipe to toggle between battle fullscreen and solitaire fullscreen |
| **Could** | Battle speed control | New | `[GDD: 05-ui-and-integration]` | Speed multiplier (x1, x2, x4) applied to battle tick rate |
| **Won't** | Tableau cursed zones (boss penalty) | -- | `[GDD: 06-debate-log]` | Rejected: negative feedback creates downward spiral |
| **Won't** | Hit â†’ Foundation delay penalty | -- | `[GDD: 06-debate-log]` | Rejected: learned helplessness risk |
| **Won't** | Fixed Suit resistance waves | -- | `[GDD: 06-debate-log]` | Rejected: contradicts Klondike rules (no Suit priority control) |
| **Won't** | Meta progression (hero unlocks, permanent upgrades) | -- | `[GDD: 06-debate-log]` | Deferred to v2: core loop validation first |

---

## 7. Non-Functional Requirements

### Performance
| Requirement | Target | Measurement |
|-------------|--------|-------------|
| Frame rate | 60 FPS minimum | Chrome DevTools |
| Max concurrent enemies | 30 on screen | Performance profiling |
| Max concurrent projectiles | 20 per Suit (80 total) | Object pooling validation |
| Battle computation | < 16ms per frame | Performance markers |
| Card animation | Same as core solitaire | Existing benchmarks |

### Compatibility
| Platform | Support Level | Notes |
|----------|--------------|-------|
| Desktop Chrome/Edge | Full support | Primary target |
| Desktop Firefox/Safari | Full support | Secondary target |
| Tablet (768px+) | Full support | Same layout, scaled |
| Mobile (<768px) | Phase-toggle mode | Swipe to switch battle/solitaire views |

### Accessibility
- Colorblind mode: Suit symbols + color (not color alone)
- Large text mode: HUD font 120% scaling
- High contrast mode: Background/foreground brightness separation

---

## 8. UI/UX Requirements

### Screen Layout (Desktop)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Time/Wave]     [Score]         [HP]  [Settings]   â”‚ <- HUD (5%)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚              Battle View (55%)                      â”‚
â”‚                                                     â”‚
â”‚    Enemy  Enemy         [Player]        Enemy      â”‚
â”‚                        (Fixed)                      â”‚
â”‚                                                     â”‚
â”‚  [â™ ï¸x3] [â™¥ï¸x2] [â™¦ï¸x1] [â™£ï¸x0]  <- Projectile counts   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Chain â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] [ğŸƒ][ğŸ‘ï¸][ğŸ’£]  <- Middle bar (5%)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚          Solitaire View (35%)                       â”‚
â”‚                                                     â”‚
â”‚    [Fâ™ ï¸] [Fâ™¥ï¸] [Fâ™¦ï¸] [Fâ™£ï¸]      [Stock] [Waste]      â”‚
â”‚  [T1] [T2] [T3] [T4] [T5] [T6] [T7]                â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### HUD Elements
- **Top bar**: Time/Wave (left), Score (center-left), HP bar (center-right), Settings (right)
- **Battle view**: 2D arena with player fixed center, enemies from all edges, projectile effects
- **Middle bar**: Chain gauge (left), Wild card slots x3 (right)
- **Solitaire view**: Standard Klondike layout with Foundation feedback effects

### Visual Feedback Requirements
| Action | Visual Effect | Audio | Timing |
|--------|--------------|-------|--------|
| Foundation placement | Suit-color particle + instant projectile fire + enemy knockback | Card place + projectile launch | < 0.1s |
| Tableau move | Chain gauge fill animation | Soft chime | Immediate |
| Enemy kill | Score popup + XP bar + wild card drop (15%) | Impact sound | Immediate |
| Wave clear | "WAVE X CLEAR" text + face-down auto-reveal glow | Fanfare | 3s display |
| Levelup | Slow-motion (0.2x) + 3-card choice UI center screen | Level-up jingle | Until choice |
| Full Suit (K) | Screen flash in Suit color + ultimate ability activation | Epic sound | 2s effect |

### Suit Color Consistency
- **Spade**: Purple (#9B59B6)
- **Heart**: Red (#E74C3C)
- **Diamond**: Blue (#3498DB)
- **Club**: Green (#2ECC71)

These colors apply to: projectiles, Foundation piles, middle bar icons, enemy weakness icons.

---

## 9. Technical Constraints

### Architecture
1. **Scene Isolation**: SurvivorsScene completely independent from TableScene and DefenseScene
2. **SolitaireState Wrapper**: Wrap (not modify) existing SolitaireState to hook Foundation events
3. **GameBridge Extension**: Add survivors-specific callbacks without breaking existing modes
4. **State Serialization**: SurvivorsState must be JSON-serializable for potential save/load
5. **Performance Budget**: 60 FPS with max 30 enemies + 80 projectiles on screen

### Integration Points
```
React (UI)
  â””â”€> GameBridge (extended with survivors callbacks)
       â””â”€> SurvivorsScene (Phaser)
            â”œâ”€> SolitaireWrapper (bottom 35%)
            â”‚    â””â”€> onFoundation â†’ ProjectileSystem
            â”‚    â””â”€> onTableauMove â†’ ChainGaugeSystem
            â”‚
            â””â”€> BattleEngine (top 55%)
                 â””â”€> onEnemyKilled â†’ WildCardManager + XP
                 â””â”€> onPlayerHit â†’ React (HP update)
```

### File Structure (New Modules)
```
web/src/game/survivors/
  SurvivorsScene.ts              # Main Phaser scene
  SurvivorsBattleEngine.ts       # 2D combat calculation
  ProjectileSystem.ts            # Projectile manager (Suit-based)
  WildCardManager.ts             # Wild card drop/storage/use
  ChainGaugeSystem.ts            # Chain gauge charge/burst
  LevelUpSystem.ts               # XP + levelup choices
  ComboTimerSystem.ts            # Combo timer + damage scaling
  WeaknessSystem.ts              # Enemy weakness assignment/display
  PlayerCharacter.ts             # Player sprite (fixed, HP, knockback)
  EnemySprite.ts                 # Enemy sprite (2D movement, weakness icon)
  ProjectileSprite.ts            # Projectile sprite (Suit-specific visuals)
  BarrierZoneRenderer.ts         # Barrier zone rendering (empty columns)
  SurvivorsState.ts              # Survivors game state
```

---

## 10. Acceptance Criteria

### Must Criteria (Blocking Release)
1. **Core Loop Functional**: 10-minute session playable from start to victory/defeat
2. **Zero Klondike Rule Changes**: Standard solitaire rules 100% preserved
3. **Foundation â†’ Projectile Link**: Immediate feedback (< 0.1s) on card placement
4. **Wild Card Safety Net**: Joker/Peek/Bomb drop and use correctly
5. **Performance**: 60 FPS maintained with 20+ enemies on screen
6. **Levelup System**: 3 levelups occur at Wave 3/6/9 with 3-choice UI
7. **Wave Progression**: 10 waves with escalating difficulty per GDD table
8. **Victory/Defeat**: Correct win/loss conditions and score screen

### Should Criteria (Quality Targets)
1. **Visual Polish**: All projectile types have distinct Suit-colored effects
2. **Audio Feedback**: Sound effects for Foundation placement, kills, levelup
3. **Combo System**: Combo timer and dual combos (Red/Black/Royal) functional
4. **Miniboss/Boss**: 2 minibosses + final boss with special mechanics
5. **Mobile Support**: Phase-toggle layout works on < 768px screens

### Could Criteria (Nice to Have)
1. **Battle Speed Control**: x1/x2/x4 speed options
2. **New Deck Dealing**: Option to deal new deck after 52-card completion
3. **Advanced Levelup Options**: All 3 categories with 5+ choices each

---

## 11. Out of Scope (v1)

| Feature | Reason | Future Consideration |
|---------|--------|---------------------|
| Meta progression (hero unlocks, permanent upgrades) | Core loop validation first | v2 feature |
| Endless mode (post-10-minute) | Session length already at upper limit | v2 feature |
| Multiplayer / co-op | Technical complexity too high | Not planned |
| Custom difficulty levels | Balancing burden for v1 | v2 feature |
| Leaderboard / daily seeds | Infrastructure not in place | v2 feature |
| Achievements / badges | Meta system required | v2 feature |
| Alternative game modes (5-wave quick mode) | Scope creep | v2 feature |

---

## 12. Risk & Mitigation

| # | Risk | Category | Prob. | Impact | Mitigation |
|---|------|----------|-------|--------|------------|
| R1 | Multitasking cognitive overload (battle + solitaire) | UX | High | High | Simplify battle (auto-targeting, fixed player); passive feedback channels (auto-reveal, barrier zones) |
| R2 | Solitaire blocking frustration (bad deal) | Gameplay | High | High | 4-layer safety net: Stock cycling, levelup aids, wave reveals, wild cards (15% drop rate) |
| R3 | Performance regression with 30+ entities | Tech | Med | High | Object pooling, particle limits, 60 FPS budget enforcement |
| R4 | Session length too long for casual players | Product | Med | Med | Target 10-min design; provide early success moments (Wave 1-3); allow mid-session quit with partial score |
| R5 | Combo timer adds unwanted pressure | UX | Med | Med | 10-second window (generous); combo is bonus not requirement; base gameplay works without it |
| R6 | Wild card drop RNG creates unfairness | Balance | Med | Med | 15% total drop rate tuned via playtesting; miniboss guaranteed drops; levelup "Solitaire Aid" as fallback |
| R7 | Survivors mode cannibalizes Defense mode | Product | Low | Med | Different player personas (Action Seeker vs Strategy Steve); track cross-mode engagement |
| R8 | SolitaireState wrapper breaks existing modes | Tech | Low | High | Comprehensive regression testing on `/play` and `/defense` after integration |

---

## 13. Success Metrics & KPIs

### Mode-Specific KPIs
| KPI | Formula | Target |
|-----|---------|--------|
| Mode Entry Rate | Survivors sessions / Total sessions | > 25% |
| Wave 5 Reach Rate | Games reaching Wave 5 / Games started | > 60% |
| Session Completion Rate | 10-minute completes / Games started | > 25% |
| Mode Win Rate | Wave 10 clears / Games started | > 20% |
| Avg Session Length | Total survivors time / Survivors sessions | 10-15 min |
| Cross-Mode Ratio | Users playing both modes / Total users | > 70% |
| S-Rank Rate | S-rank games / Wave 10 clears | ~3% |

### Impact on Existing KPIs
| Existing KPI | Expected Impact | Monitoring Plan |
|-------------|----------------|-----------------|
| Overall D1 Retention | +8-12% (new content hook) | Pre/post comparison |
| Total Session Count | +0.6 sessions/user/day | Segmented analysis |
| Avg Session Length | Increase (survivors sessions longer) | Mode-segmented tracking |
| Core Solitaire Usage | Stable or slight decrease | Monitor for >15% drop |

---

## 14. Competitive Reference

| Game | Mode/Feature | Similarity | Our Advantage |
|------|-------------|-----------|---------------|
| Vampire Survivors | Auto-attacking projectiles, levelup choices | Real-time survival + upgrade selection | Our resource acquisition is skill-based (solitaire) not passive; fixed player position reduces control complexity |
| Brotato | Fixed-position auto-battler | Stationary combat with projectile variety | Our meta-layer is solitaire (familiar, strategic) not shop/economy RNG |
| Solitairica | Solitaire + RPG combat | Card mechanics power combat | We preserve full Klondike rules; combat is spatial/real-time not turn-based |
| 20 Minutes Till Dawn | Survivors-like with build variety | Projectile customization via upgrades | Our upgrades tied to Foundation progress (solitaire skill) creates unique dual-task gameplay |

---

## 15. Release Plan

### Integration Timeline

```mermaid
gantt
    title Solitaire Survivors Integration Timeline
    dateFormat YYYY-MM-DD
    section Core Game
    Existing modes (Play/Defense) :done, a0, 2025-01-01, 2026-02-17
    section Survivors Mode
    Prototype (core loop MVP)         :a1, 2026-02-18, 28d
    Alpha (all Must features)         :a2, after a1, 35d
    Beta (Should features + balance)  :a3, after a2, 28d
    Launch                            :milestone, after a3, 0d
    Post-launch (Could features)      :a4, after a3, 21d
```

### Milestone Table
| Phase | Duration | Deliverables | Gate Criteria |
|-------|----------|-------------|---------------|
| Prototype | 4 weeks | SurvivorsScene boots; real-time solitaire + battle functional; 3 enemy types; basic projectile system | Internal playtest: core loop feels cohesive; no Klondike rule violations |
| Alpha | 5 weeks | All Must features; 6 enemy types; 10 waves; levelup system; wild cards; scoring | Feature complete; all Must acceptance criteria pass; 60 FPS on target hardware |
| Beta | 4 weeks | Should features (combo timer, dual combos, minibosses, boss, chain gauge); balance tuning; visual polish | Wave 5 reach > 60%; session completion > 20%; zero P0 bugs |
| Launch | -- | Public release at `/survivors`; analytics live | KPI targets met; zero P0/P1 bugs; cross-browser compatibility verified |
| Post-launch | 3 weeks | Could features (Bomb dual-use, new deck option, speed control, mobile optimization) | Adoption rate > 40% within 14 days; D7 retention > 30% |

---

## 16. Appendix

### GDD Cross-Reference Table
| PRD Section | GDD Document | GDD Section |
|-------------|-------------|-------------|
| Core Loop & Session | `01-core-loop.md` | ì‹¤ì‹œê°„ ë™ì‹œ ì§„í–‰, ì–‘ë°©í–¥ í”¼ë“œë°±, ìŠ¹ë¦¬/íŒ¨ë°° ì¡°ê±´ |
| Feature: Projectiles | `02-projectile-system.md` | Suit ë§¤í•‘, íˆ¬ì‚¬ì²´ ìˆ˜ ê³µì‹, ì½¤ë³´ íƒ€ì´ë¨¸, K ì™„ì„± íŠ¹ìˆ˜íš¨ê³¼ |
| Feature: Enemies/Waves | `03-enemy-and-wave.md` | ì  íƒ€ì…, ìŠ¤í° ë©”ì»¤ë‹ˆì¦˜, ì•½ì  ì‹œìŠ¤í…œ, 10 ì›¨ì´ë¸Œ êµ¬ì¡°, ë³´ìŠ¤ |
| Feature: Feedback/Safety | `04-feedback-and-safety.md` | ì–‘ë°©í–¥ í”¼ë“œë°± ì±„ë„, ì•¼ìƒì¹´ë“œ, 4ì¤‘ ì•ˆì „ì¥ì¹˜, ì²´ì¸ ê²Œì´ì§€ |
| Feature: UI/Layout | `05-ui-and-integration.md` | í™”ë©´ êµ¬ì¡°, HUD, ë ˆë²¨ì—… UI, ê¸°ì¡´ ì½”ë“œë² ì´ìŠ¤ í†µí•© |
| Design Decisions | `06-debate-log.md` | í† ë¡  ê³¼ì •, í•©ì˜/ë¶ˆì±„íƒ í•­ëª©, Classic vs Creative ë¹„êµ |

### Glossary
| Term | Definition |
|------|-----------|
| Core Solitaire | The existing Klondike solitaire mode in Solitary (`/play`) |
| Defense Mode | The existing Solitaire Defense game mode (`/defense`) |
| Survivors Mode | The new Solitaire Survivors game mode (`/survivors`) |
| Foundation | Standard Klondike foundation piles; in Survivors Mode, also the projectile production mechanism |
| Projectile Tier | Foundation ìµœê³  Rankì— ë”°ë¥¸ íˆ¬ì‚¬ì²´ ìˆ˜ (0-5ë°œ) |
| Wild Card | ì  ì²˜ì¹˜ ì‹œ ë“œëë˜ëŠ” íŠ¹ìˆ˜ ì¹´ë“œ (Joker/Peek/Bomb) |
| Combo Timer | ê°™ì€ Suitì— 10ì´ˆ ë‚´ ì—°ì† ì ì¬ ì‹œ ë°ë¯¸ì§€ ë°°ìœ¨ ì¦ê°€ (ìµœëŒ€ x2.0) |
| Chain Gauge | Tableau ì´ë™ìœ¼ë¡œ ì¶©ì „ë˜ëŠ” ê²Œì´ì§€; 100% ì‹œ 3ì´ˆê°„ ë°œì‚¬ì†ë„ x2 ë²„ìŠ¤íŠ¸ |
| Dual Combo | 2ê°œ ì´ìƒ Suitê°€ íŠ¹ì • Tier ì¡°ê±´ ì¶©ì¡± ì‹œ ë°œë™ë˜ëŠ” ìœµí•© íˆ¬ì‚¬ì²´ (Red/Black/Royal) |
| Barrier Zone | ë¹ˆ Tableau ì—´ì— ëŒ€ì‘í•˜ëŠ” ì „íˆ¬ ì˜ì—­ì˜ ì  ê°ì† ì¡´ (50% slow) |
| Suit Weakness | ê° ì ì—ê²Œ ë¶€ì—¬ëœ 1ê°œ Suit ì•½ì  (í•´ë‹¹ Suit íˆ¬ì‚¬ì²´ ë°ë¯¸ì§€ x2.0) |
| GameBridge | React-to-Phaser communication singleton (`game/bridge/GameBridge.ts`) |
| SolitaireState | Pure game logic class for Klondike rules (`solver/SolitaireState.ts`) |

### Scoring System Detail

**ì ìˆ˜ í•­ëª©**:
- ìƒì¡´ ì‹œê°„: ì´ˆë‹¹ 1ì  (ìµœëŒ€ 600ì )
- ì¼ë°˜ ì  ì²˜ì¹˜: ì ë‹¹ 10ì 
- ë¯¸ë‹ˆë³´ìŠ¤ ì²˜ì¹˜: ë³´ìŠ¤ë‹¹ 50ì  (ìµœëŒ€ 100ì )
- ìµœì¢… ë³´ìŠ¤ ì²˜ì¹˜: 500ì 
- Foundation ì¹´ë“œ: ì¹´ë“œë‹¹ 20ì  (ìµœëŒ€ 1040ì )
- Suit ì½¤ë³´: ì½¤ë³´ë‹¹ 25ì 
- ë“€ì–¼ ì½¤ë³´ í•´ê¸ˆ: ì½¤ë³´ë‹¹ 100ì  (ìµœëŒ€ 300ì )
- Full Suit ì™„ì„±: Suitë‹¹ 200ì  (ìµœëŒ€ 800ì )
- ì”ì—¬ HP: HP 1ë‹¹ 5ì  (ìµœëŒ€ 500ì )
- ì†”ë¦¬í…Œì–´ ì™„ì„±: 1000ì 

**ë“±ê¸‰ ê¸°ì¤€**:
- S: 5000+
- A: 3500+
- B: 2000+
- C: 1000+
- D: ~999

---

## 17. êµ¬í˜„ ìš°ì„ ìˆœìœ„ Summary

### Phase 1: í•µì‹¬ ë£¨í”„ (MVP)
1. SurvivorsScene ê³¨ê²© (ìƒí•˜ ë¶„í•  ë ˆì´ì•„ì›ƒ)
2. SolitaireWrapper + Foundation ì´ë²¤íŠ¸ í›„í‚¹
3. ProjectileSystem (ê¸°ë³¸ ë°œì‚¬, Suitë³„ 4ì¢…)
4. BattleEngine (2D ì  ì´ë™ + ì¶©ëŒ + HP)
5. ê¸°ë³¸ HUD (HP, ì‹œê°„, ì ìˆ˜, ì›¨ì´ë¸Œ)

### Phase 2: ì „íˆ¬ ì‹œìŠ¤í…œ
1. ì  ì•½ì  ì‹œìŠ¤í…œ (ì•„ì´ì½˜ í‘œì‹œ + x2.0 ë°ë¯¸ì§€)
2. íˆ¬ì‚¬ì²´ Tier ìŠ¤ì¼€ì¼ë§ (ceil(Rank/3) ê³µì‹)
3. Wild card ë“œë (Joker ìš°ì„ , Peek/Bombì€ Phase 3)
4. ë ˆë²¨ì—… ì‹œìŠ¤í…œ (XP + 3-choice UI)

### Phase 3: í”¼ë“œë°± ë£¨í”„
1. ì½¤ë³´ íƒ€ì´ë¨¸ (10ì´ˆ ìœˆë„ìš°, x1.0 â†’ x2.0)
2. ì²´ì¸ ê²Œì´ì§€ (Tableau ì´ë™ â†’ 100% â†’ ë°œì‚¬ì†ë„ x2 ë²„ìŠ¤íŠ¸)
3. ì›¨ì´ë¸Œ í´ë¦¬ì–´ ë³´ìƒ (face-down 1ì¥ ìë™ reveal)
4. Peek/Bomb wild card êµ¬í˜„

### Phase 4: ì§„í–‰ë„ ì‹œìŠ¤í…œ
1. ë“€ì–¼ ì½¤ë³´ (Red/Black/Royal)
2. Full Suit (K) íŠ¹ìˆ˜ íš¨ê³¼
3. ë¯¸ë‹ˆë³´ìŠ¤ 2ì¢… (Brute/Shadow)
4. ìµœì¢… ë³´ìŠ¤ (King of Ruin, 3-phase)

### Phase 5: í´ë¦¬ì‹œ
1. íŒŒí‹°í´ ì´í™íŠ¸ (ëª¨ë“  Suit ìƒ‰ìƒ)
2. ì‚¬ìš´ë“œ ì´í™íŠ¸ (ì¹´ë“œ ì ì¬, ì  ì²˜ì¹˜, ë ˆë²¨ì—…)
3. ê²°ê³„ ì¡´ ë Œë”ë§ (ë¹ˆ ì—´ â†’ ê°ì† ì˜ì—­)
4. ê²Œì„ ì˜¤ë²„/ìŠ¹ë¦¬ í™”ë©´ (ìŠ¤ì½”ì–´ ì§‘ê³„ + ë“±ê¸‰)

---

## Summary

Solitaire SurvivorsëŠ” "ì‹¤ì‹œê°„ ë™ì‹œ ì§„í–‰"ê³¼ "ì–‘ë°©í–¥ ê¸ì • í”¼ë“œë°±"ì´ë¼ëŠ” ë‘ ì¶•ìœ¼ë¡œ Klondike ì†”ë¦¬í…Œì–´ì™€ Survivors-like ì•¡ì…˜ì„ ìœµí•©í•œë‹¤. í”Œë ˆì´ì–´ëŠ” í•˜ë‹¨ì—ì„œ í‘œì¤€ ì†”ë¦¬í…Œì–´ ê·œì¹™ìœ¼ë¡œ ì¹´ë“œë¥¼ ì¡°ì‘í•˜ë©°, Foundation ì ì¬ê°€ ìƒë‹¨ ì „íˆ¬ì˜ íˆ¬ì‚¬ì²´ ê°•í™”ë¡œ ì¦‰ì‹œ ë°˜ì˜ëœë‹¤. ì—­ë°©í–¥ìœ¼ë¡œ ì  ì²˜ì¹˜ ì‹œ ì•¼ìƒì¹´ë“œê°€ ë“œëë˜ì–´ ë§‰íŒ ì†”ë¦¬í…Œì–´ë¥¼ ëŒíŒŒí•˜ëŠ” êµ¬ì¡°ë¥¼ ë§Œë“ ë‹¤.

4ì¤‘ ì•ˆì „ì¥ì¹˜(Stock ë¬´í•œ ìˆœí™˜, ë ˆë²¨ì—… ë³´ì¡°, ì›¨ì´ë¸Œ reveal, ì•¼ìƒì¹´ë“œ)ëŠ” Klondikeì˜ ë³¸ì§ˆì  ë§‰í˜ ë¬¸ì œë¥¼ ì™„í™”í•˜ë˜, ê·œì¹™ ìì²´ëŠ” ì¼ì²´ ë³€ê²½í•˜ì§€ ì•ŠëŠ”ë‹¤. ë¶€ì •ì  ì—­ë°©í–¥ í”¼ë“œë°±(ì €ì£¼, íŒ¨ë„í‹°)ì€ ëª¨ë‘ ë°°ì œí•˜ì—¬ "ì•½í•´ì§ˆìˆ˜ë¡ ë” ì•½í•´ì§€ëŠ”" í•˜í–¥ ë‚˜ì„ ì„ ë°©ì§€í•œë‹¤.

ê¸°ì¡´ Defense ëª¨ë“œì™€ì˜ ì°¨ë³„ì : (1) í„´ì œ â†’ ì‹¤ì‹œê°„ ì „í™˜, (2) ìœ ë‹› ì†Œí™˜ â†’ íˆ¬ì‚¬ì²´ ê°•í™”, (3) ë‹¨ë°©í–¥ â†’ ì–‘ë°©í–¥ í”¼ë“œë°±, (4) 1D ë ˆì¸ â†’ 2D ì•„ë ˆë‚˜. ëª©í‘œëŠ” 10ë¶„ ë‚´ë‚´ "ë‹¤ìŒ ìˆ˜ê°€ ìˆë‹¤"ëŠ” ëŠë‚Œì„ ìœ ì§€í•˜ë©° 85-90% ì™„ì£¼ìœ¨ì„ ë‹¬ì„±í•˜ëŠ” ê²ƒì´ë‹¤.
